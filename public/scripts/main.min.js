function Utils(){this.keysmap={escape:27}}function ParallaxFactory(e){this.parallaxPackage={},this.maxDeg=e}function Countdown(e,t){this.endtime=e,this.utils=new Utils,this.$target=t,this.timeinterval=void 0}Utils.prototype={convertToTwoDigits:function(e){return e<10?"0"+e:e},isCharacterKeyPress:function(e){return"undefined"==typeof e.which||"number"==typeof e.which&&e.which>0&&(!e.ctrlKey&&!e.metaKey&&!e.altKey&&8!=e.which)}},ParallaxFactory.prototype={getMatrix:function(e,t){var o=this,i=e.clientWidth/2,n=e.clientHeight/2,a=i-(t.pageX-e.offsetLeft),s=n-(t.pageY-e.offsetTop);return o.parallaxPackage.degX=s/n*o.maxDeg+"deg",o.parallaxPackage.degY=a/i*-o.maxDeg+"deg",o.parallaxPackage.X=(t.pageX*-1/2+i/2)/8,o.parallaxPackage.Y=(t.pageY*-1/2+n/2)/8,o.parallaxPackage}},Countdown.prototype={getTimeRemaining:function(e){var t=Date.parse(e)-Date.parse(new Date),o=Math.floor(t/1e3%60),i=Math.floor(t/1e3/60%60),n=Math.floor(t/36e5%24),a=Math.floor(t/864e5);return{total:t,days:this.utils.convertToTwoDigits(a),hours:this.utils.convertToTwoDigits(n),minutes:this.utils.convertToTwoDigits(i),seconds:this.utils.convertToTwoDigits(o)}},render:function(){var e=this.getTimeRemaining(this.endtime);this.$target.children(".days").html(e.days),this.$target.children(".hours").html(e.hours),this.$target.children(".mins").html(e.minutes),this.$target.children(".secs").html(e.seconds),e.total<=0&&(clearInterval(this.timeinterval),this.$target.hide())},initCountdownClock:function(){var e=this;console.log("that.$target",e.$target.children()),e.render(),e.timeinterval=setInterval(function(){e.render()},1e3),setTimeout(function(){e.$target.removeClass("hidden")},500)},destroy:function(){var e=this;clearInterval(e.timeinterval),this.$target.addClass("hidden")}},rko.carouselView=function(e){var t={swiper:void 0,swiperGallery:void 0,krizaTimeline:void 0,swiperLock:void 0,bindables:{},weddingCountdown:void 0,krizaPhotoTimeline:void 0,mattPhotoTimeline:void 0,currentSlideId:void 0};return t.init=function(t,o){console.log("view inited"),$("#main").html(t),$("#menu").html(o),$("body").removeClass().addClass("carouselMode"),$(document).on("keyup keypress",function(e){var t=e.keyCode||e.which;if(13===t)return e.preventDefault(),!1});var i,n=this;setTimeout(function(){$("#main").removeClass("loading")},100),$("#landing .km-logo").one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(e){console.log("e",e),"transitionend"===e.type&&($("#main").removeClass("entranceMode"),n.bind())}),$("#kriza .gallery-scroller").imagesLoaded(function(){i=-$("#kriza .gallery-scroller").innerHeight()+$(e).innerHeight(),n.krizaPhotoTimeline=new TimelineLite({paused:!0}),n.krizaPhotoTimeline.to($("#kriza .gallery-scroller"),300,{y:i+"px",force3D:!0,ease:Quad.easeInOut})}),$("#matt .gallery-scroller").imagesLoaded(function(){i=-$("#matt .gallery-scroller").innerHeight()+$(e).innerHeight(),n.mattPhotoTimeline=new TimelineLite({paused:!0}),n.mattPhotoTimeline.to($("#matt .gallery-scroller"),300,{y:i+"px",force3D:!0,ease:Quad.easeInOut})})},t.setupRSVPForm=function(){var e=$("#plusone-checkbox-result"),t=$("#plusone-input"),o=$("#rsvp-form"),i=$("#plusone-checkbox");i.on("click",function(o){$(o.target).is(":checked")?(e.val("Yes"),t.removeClass("hidden")):(e.val("No"),t.addClass("hidden"))}),o.submit(function(e){var t=$(this).attr("action");$.ajax({type:"POST",url:t,data:$(this).serialize(),success:function(e){e=$.parseJSON(e),"success"===e.result&&($("#rsvp-thankyou").addClass("show"),setTimeout(function(){$("#rsvp-thankyou").removeClass("show")},5e3),$("#rsvp-submit-btn").hide(),$("#rsvp-form input").prop("disabled",!0),$("#rsvp-form").addClass("disabled"),$(".rsvp-button-external").hide())}}),e.preventDefault()})},t.unbindRSVPForm=function(){this.bindables.$plusOneCheckbox.off(),this.bindables.$rsvpForm.off()},t.handleCarouselSlideChangeStart=function(e){var o=$(".carousel-slide-active"),i=$(".swiper-pagination"),n=$("#menu-btn"),a=$("#menu");t.currentSlideId=o[0].id,o.hasClass("light-mode")||o.hasClass("no-pagination")?(n.addClass("light-mode"),a.addClass("light-mode")):(n.removeClass("light-mode"),a.removeClass("light-mode")),o.hasClass("light-mode")?i.addClass("light-mode"):i.removeClass("light-mode"),o.hasClass("no-pagination")?i.addClass("transparent-mode"):i.removeClass("transparent-mode"),"invitation"===t.currentSlideId?t.weddingCountdown.initCountdownClock():t.weddingCountdown.destroy(),e.disableMousewheelControl()},t.handleCarouselSlideChangeEnd=function(e){console.log("swiper",e.activeIndex),console.log("(swiper.slides.length -1)",e.slides.length-1),e.activeIndex==e.slides.length-1?$("#backToTop").addClass("show"):$("#backToTop").removeClass("show"),"gallery"===t.currentSlideId?"undefined"==typeof t.swiperGallery?t.swiperGallery=new Swiper(".swiper-container-gallery",{pagination:".swiper-pagination-gallery",direction:"horizontal",slidesPerView:1,effect:"fade",paginationClickable:!0,slideActiveClass:"gallery-slide-active",spaceBetween:0,speed:700,autoplay:3e3,autoplayDisableOnInteraction:!1,simulateTouch:!1,keyboardControl:!0,mousewheelControl:!0,mousewheelForceToAxis:!0,nextButton:".swiper-button-next",prevButton:".swiper-button-prev"}):t.swiperGallery.startAutoplay():"undefined"!=typeof t.swiperGallery&&t.swiperGallery.stopAutoplay(),t.swiperLock=setTimeout(function(){e.enableMousewheelControl()},600)},t.setupCarousel=function(){var e=this;console.log("created swiper!"),t.swiper=new Swiper(".swiper-container",{pagination:".swiper-pagination",direction:"vertical",slidesPerView:1,slideActiveClass:"carousel-slide-active",paginationClickable:!0,spaceBetween:0,speed:700,mousewheelControl:!0,keyboardControl:!0,simulateTouch:!1,mousewheelForceToAxis:!0,mousewheelSensitivity:.5,onInit:function(e){setTimeout(function(){$(".swiper-pagination").addClass("active")},10)},onSlideChangeStart:function(t){e.handleCarouselSlideChangeStart(t)},onSlideChangeEnd:function(t){e.handleCarouselSlideChangeEnd(t)}})},t.setupParallaxEffects=function(){var e,t=new ParallaxFactory(5);$("#landing").mousemove(function(o){e=t.getMatrix(this,o),$("#parallax-landing").css("transform","translate3d("+e.X/2+"px, "+e.Y/2+"px, -200px)"),$("#landing .km-logo").css("transform","perspective(200px) translate3d("+-e.X/12+"px, "+-e.Y/12+"px, 0)")}),$("#quote").mousemove(function(o){e=t.getMatrix(this,o),$("#quote-landing").css("transform","perspective(600px) translate3d("+e.X/2+"px, "+e.Y/2+"px, -10px)"),$("#quote cite").css("transform","perspective(600px) translate3d("+-e.X/12+"px, "+-e.Y/12+"px, 0)")}),$("#location").mousemove(function(o){e=t.getMatrix(this,o),$("#location-landing").css("transform","perspective(600px) translate3d("+e.X/2+"px, "+e.Y/2+"px, -10px)")}),$("#seeyou").mousemove(function(o){e=t.getMatrix(this,o),$("#seeyou-landing").css("transform","perspective(600px) translate3d("+e.X/5+"px, "+e.Y/5+"px, -10px)")})},t.bind=function(){console.log("bind called!");this.setupRSVPForm(),this.setupCarousel(),this.setupParallaxEffects(),this.weddingCountdown=new Countdown("2017-06-23",$("#invitation .countdown")),$("#backToTop").on("click",function(){t.swiper.slideTo(0,2e3)}),$("#menu-btn").on("click",function(){console.log("hit"),$("body").hasClass("menuMode")?$("body").removeClass("menuMode"):$("body").addClass("menuMode")}),$(".rsvp-button-external").on("click",function(){$("body").hasClass("menuMode")||$("#menu-btn").trigger("click"),$("#firstname").focus()}),$("#matt .gallery-movingUp-area").hover(function(){t.mattPhotoTimeline.reverse(),t.mattPhotoTimeline.timeScale(25)},function(){t.mattPhotoTimeline.stop(),t.mattPhotoTimeline.timeScale(1)}),$("#kriza .gallery-movingUp-area").hover(function(){t.krizaPhotoTimeline.reverse(),t.krizaPhotoTimeline.timeScale(25)},function(){t.krizaPhotoTimeline.stop(),t.krizaPhotoTimeline.timeScale(1)}),$("#matt .gallery-movingDown-area").hover(function(){t.mattPhotoTimeline.play(),t.mattPhotoTimeline.timeScale(25)},function(){t.mattPhotoTimeline.stop(),t.mattPhotoTimeline.timeScale(1)}),$("#kriza .gallery-movingDown-area").hover(function(){t.krizaPhotoTimeline.play(),t.krizaPhotoTimeline.timeScale(25)},function(){t.krizaPhotoTimeline.stop(),t.krizaPhotoTimeline.timeScale(1)})},t}(window),rko.passwordView=function(e){var t={previousModeLabel:void 0,modeLabel:"passwordMode",bindables:{$passwordInput:$("#password-input"),$passwordForm:$("#password-form"),$doc:$(document)},$body:$("body"),$passwordErrorMsg:$("#login-error-msg"),helloMessages:["Hello!","안녕하세요!"]},o=new Utils,i=rko.carouselView;return t.bind=function(){var e,n=this;n.bindables.$passwordInput.keydown(function(e){n.hidePasswordErrorMessage()}),n.bindables.$doc.keydown(function(t){e=t.keyCode,n.$body.hasClass(n.previousModeLabel)&&o.isCharacterKeyPress(t)&&e!==o.keysmap.escape&&(n.$body.removeClass().addClass(n.modeLabel),n.bindables.$passwordInput.focus()),n.$body.hasClass(n.modeLabel)&&e===o.keysmap.escape&&(n.$body.removeClass().addClass(n.previousModeLabel),n.bindables.$passwordInput.val(""))}),n.bindables.$passwordForm.submit(function(e){var o=$(this).attr("action");console.log("pw form submit!"),$.ajax({type:"POST",url:o,data:$(this).serialize(),success:function(e){e=$.parseJSON(e),"success"===e.result?($(".password-hint").html(t.helloMessages[Math.floor(Math.random()*t.helloMessages.length)]),i.init(e.html,e.menuHtml)):n.showPasswordErrorMessage()}}),e.preventDefault()})},t.unbind=function(){var e=this.bindables;for(var t in e)e.hasOwnProperty(t)&&e[t].off()},t.showPasswordErrorMessage=function(){this.$passwordErrorMsg.addClass("show")},t.hidePasswordErrorMessage=function(){this.$passwordErrorMsg.removeClass("show")},t.init=function(e){this.previousModeLabel=e,this.bind()},t}(window),rko.app=function(e){var t={previousMode:void 0,modeLabel:"introMode",$lockIcon:$(".lock-icon"),$logo:$(".logo"),$background:$("#parallax-auth"),$viewContainer:$("#lock")},o=rko.passwordView;return t.init=function(){setTimeout(function(){console.log("loaded!"),t.$viewContainer.removeClass("loading")},100);var e=this;$(".logo").one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(t){e.$viewContainer.removeClass("entranceMode"),console.log(t),"transitionend"===t.type&&(e.setupParallaxEffects(),o.init(e.modeLabel))})},t.setupParallaxEffects=function(){var e,t=new ParallaxFactory(5),o=this;this.$viewContainer.mousemove(function(i){e=t.getMatrix(this,i),o.$lockIcon.css("transform","perspective(40px) translate3d("+-e.X/4+"px, "+-e.Y/4+"px, 0) rotateX("+e.degX+") rotateY("+e.degY+")"),o.$logo.css("transform","perspective(500px) translate3d("+-e.X/8+"px, "+-e.Y/8+"px, 0) rotateX("+e.degX+") rotateY("+e.degY+")"),o.$background.css("transform","perspective(1000px) translate3d("+e.X/2+"px, "+e.Y/2+"px, -20px)")})},t}(window);