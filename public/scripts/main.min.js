"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,a,i){return a&&e(t.prototype,a),i&&e(t,i),t}}(),Utils=function(){function e(){_classCallCheck(this,e),this.keysmap={escape:27}}return _createClass(e,[{key:"convertToTwoDigits",value:function(e){return e<10?"0"+e:e}},{key:"isCharacterKeyPress",value:function(e){return"undefined"==typeof e.which||"number"==typeof e.which&&e.which>0&&(!e.ctrlKey&&!e.metaKey&&!e.altKey&&8!=e.which)}},{key:"isTouchDevice",value:function(){return"undefined"!=typeof window.ontouchstart}},{key:"isValidateEmail",value:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}},{key:"isValidateFirstAndLastName",value:function(e){var t=e.split(" ").length;return 1!==t}},{key:"disableDefaultTouch",value:function(){$(document).on("touchmove",function(e){e.preventDefault()});var e=!1;$("body").on("touchstart",".scrollable",function(t){e||(e=!0,0===t.currentTarget.scrollTop?t.currentTarget.scrollTop=1:t.currentTarget.scrollHeight===t.currentTarget.scrollTop+t.currentTarget.offsetHeight&&(t.currentTarget.scrollTop-=1),e=!1)}),$("body").on("touchmove",".scrollable",function(e){e.stopPropagation()})}}]),e}(),ParallaxFactory=function(){function e(t){_classCallCheck(this,e),this.parallaxPackage={},this.maxDeg=t}return _createClass(e,[{key:"getMatrix",value:function(e,t){var a=this,i=e.clientWidth/2,o=e.clientHeight/2,n=i-(t.pageX-e.offsetLeft),l=o-(t.pageY-e.offsetTop);return a.parallaxPackage.degX=l/o*a.maxDeg+"deg",a.parallaxPackage.degY=n/i*-a.maxDeg+"deg",a.parallaxPackage.X=(t.pageX*-1/2+i/2)/8,a.parallaxPackage.Y=(t.pageY*-1/2+o/2)/8,a.parallaxPackage}}]),e}(),Countdown=function(){function e(t,a){_classCallCheck(this,e),this.endtime=t,this.$target=a,this.utils=new Utils,this.timeinterval=void 0}return _createClass(e,[{key:"getTimeRemaining",value:function(e){var t=Date.parse(e)-Date.parse(new Date),a=Math.floor(t/1e3%60),i=Math.floor(t/1e3/60%60),o=Math.floor(t/36e5%24),n=Math.floor(t/864e5);return{total:t,days:this.utils.convertToTwoDigits(n),hours:this.utils.convertToTwoDigits(o),minutes:this.utils.convertToTwoDigits(i),seconds:this.utils.convertToTwoDigits(a)}}},{key:"render",value:function(){var e=this.getTimeRemaining(this.endtime);this.$target.children(".days").html(e.days),this.$target.children(".hours").html(e.hours),this.$target.children(".mins").html(e.minutes),this.$target.children(".secs").html(e.seconds),e.total<=0&&(clearInterval(this.timeinterval),this.$target.hide())}},{key:"initCountdownClock",value:function(){this.render(),this.timeinterval=setInterval(function(){this.render()}.bind(this),1e3),setTimeout(function(){this.$target.removeClass("hidden")}.bind(this),500)}},{key:"destroy",value:function(){clearInterval(this.timeinterval),this.$target.addClass("hidden")}}]),e}();rko.carouselView=function(e){var t={swiper:void 0,swiperGallery:void 0,krizaTimeline:void 0,swiperLock:void 0,bindables:{},weddingCountdown:void 0,krizaPhotoTimeline:void 0,mattPhotoTimeline:void 0,currentSlideId:void 0},a=new Utils;return t.init=function(){$("body").removeClass().addClass("carouselMode"),$(document).on("keyup keypress",function(e){var t=e.keyCode||e.which;if(13===t)return e.preventDefault(),!1});var t,i=this;setTimeout(function(){$("#main").removeClass("loading")},100),a.isTouchDevice()?($("#main").removeClass("entranceMode"),i.bind()):$("#landing .km-logo").one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(e){"transitionend"===e.type&&($("#main").removeClass("entranceMode"),i.bind())}),$("#kriza .gallery-scroller").imagesLoaded(function(){t=-$("#kriza .gallery-scroller").innerHeight()+$(e).innerHeight(),i.krizaPhotoTimeline=new TimelineLite({paused:!0}),i.krizaPhotoTimeline.to($("#kriza .gallery-scroller"),300,{y:t+"px",force3D:!0,ease:Linear.easeNone})}),$("#matt .gallery-scroller").imagesLoaded(function(){t=-$("#matt .gallery-scroller").innerHeight()+$(e).innerHeight(),i.mattPhotoTimeline=new TimelineLite({paused:!0}),i.mattPhotoTimeline.to($("#matt .gallery-scroller"),300,{y:t+"px",force3D:!0,ease:Linear.easeNone})})},t.setupRSVPForm=function(){var e=$("#plusone-checkbox-result"),t=$("#plusone-input"),i=$("#rsvp-form"),o=$("#plusone-checkbox");o.on("click",function(a){$(a.target).is(":checked")?(e.val("Yes"),t.removeClass("hidden")):(e.val("No"),t.addClass("hidden"))}),i.submit(function(e){var t=$(this).attr("action");return""===$("#firstname").val()?(alert("Please enter your name"),!1):a.isValidateFirstAndLastName($("#firstname").val())?""===$("#email").val()?(alert("Please enter your email"),!1):a.isValidateEmail($("#email").val())?o.is(":checked")&&""===$("#plusone-name").val()?(alert("Please enter your partner's name"),!1):""===$("#plusone-name").val()||a.isValidateFirstAndLastName($("#plusone-name").val())?($.ajax({type:"POST",url:t,data:$(this).serialize(),success:function(e){e=$.parseJSON(e),"success"===e.result?($("#rsvp-thankyou").addClass("show"),setTimeout(function(){$("#rsvp-thankyou").removeClass("show")},5e3),$("#rsvp-submit-btn").hide(),$("#rsvp-form input").prop("disabled",!0),$("#rsvp-form").addClass("disabled"),$(".rsvp-button-external").hide()):"rsvp_existed"===e.result&&alert("You have already RSVPed with the email: "+$("#email").val()+". Thank you and see you soon! \n - Kriza & Matt")}}),void e.preventDefault()):(alert("Please enter both first and last name for your partner (Separating with a space)"),!1):(alert("Please enter a valid email"),!1):(alert("Please enter both first and last name (Separating with a space)"),!1)})},t.unbindRSVPForm=function(){this.bindables.$plusOneCheckbox.off(),this.bindables.$rsvpForm.off()},t.handleCarouselSlideChangeStart=function(e){var a=$(".carousel-slide-active"),i=$(".swiper-pagination"),o=$("#menu-btn"),n=$("#menu");t.currentSlideId=a[0].id,a.hasClass("light-mode")?(o.addClass("light-mode"),n.addClass("light-mode")):(o.removeClass("light-mode"),n.removeClass("light-mode")),a.hasClass("light-mode-mobile")?(o.addClass("light-mode-mobile"),n.addClass("light-mode-mobile")):(o.removeClass("light-mode-mobile"),n.removeClass("light-mode-mobile")),a.hasClass("dark-mode-mobile")?(o.addClass("dark-mode-mobile"),n.addClass("dark-mode-mobile")):(o.removeClass("dark-mode-mobile"),n.removeClass("dark-mode-mobile")),a.hasClass("light-mode")?i.addClass("light-mode"):i.removeClass("light-mode"),a.hasClass("no-pagination")?i.addClass("transparent-mode"):i.removeClass("transparent-mode"),"invitation"===t.currentSlideId?"undefined"!=typeof t.weddingCountdown&&t.weddingCountdown.initCountdownClock():"undefined"!=typeof t.weddingCountdown&&t.weddingCountdown.destroy(),e.disableMousewheelControl(),"kriza"===t.currentSlideId&&t.mattPhotoTimeline.stop(),"matt"===t.currentSlideId&&t.krizaPhotoTimeline.stop()},t.handleCarouselSlideChangeEnd=function(e){e.activeIndex==e.slides.length-1?$("#backToTop").addClass("show"):$("#backToTop").removeClass("show"),"gallery"===t.currentSlideId?t.swiperGallery.startAutoplay():t.swiperGallery.stopAutoplay(),"kriza"===t.currentSlideId?t.personalGallery.startAutoplay():t.personalGallery.stopAutoplay(),"matt"===t.currentSlideId?t.personalGallery2.startAutoplay():t.personalGallery2.stopAutoplay(),t.swiperLock=setTimeout(function(){e.enableMousewheelControl()},600)},t.setupCarousel=function(){var e=this;t.personalGallery=new Swiper(".swiper-container-personalGallery",{direction:"horizontal",slidesPerView:1,effect:"fade",slideActiveClass:"gallery-slide-active",spaceBetween:0,speed:700,autoplay:3e3,autoplayDisableOnInteraction:!1,simulateTouch:!1,keyboardControl:!1,loop:!0,noSwiping:!0,mousewheelForceToAxis:!0}),t.personalGallery.stopAutoplay(),t.personalGallery2=new Swiper(".swiper-container-personalGallery2",{direction:"horizontal",slidesPerView:1,effect:"fade",paginationClickable:!0,slideActiveClass:"gallery-slide-active",spaceBetween:0,speed:700,autoplay:3e3,autoplayDisableOnInteraction:!1,simulateTouch:!1,keyboardControl:!1,noSwiping:!0,loop:!0,mousewheelForceToAxis:!0}),t.personalGallery2.stopAutoplay(),t.swiperGallery=new Swiper(".swiper-container-gallery",{pagination:".swiper-pagination-gallery",direction:"horizontal",slidesPerView:1,effect:"fade",paginationClickable:!0,slideActiveClass:"gallery-slide-active",spaceBetween:0,speed:700,autoplay:3e3,autoplayDisableOnInteraction:!1,simulateTouch:!1,keyboardControl:!0,mousewheelControl:!0,mousewheelForceToAxis:!0,nextButton:".swiper-button-next",prevButton:".swiper-button-prev"}),t.swiperGallery.stopAutoplay(),t.swiper=new Swiper(".swiper-container",{pagination:".swiper-pagination",direction:"vertical",slidesPerView:1,slideActiveClass:"carousel-slide-active",paginationClickable:!0,spaceBetween:0,speed:700,mousewheelControl:!0,keyboardControl:!0,simulateTouch:!1,mousewheelForceToAxis:!0,mousewheelSensitivity:.5,onInit:function(e){setTimeout(function(){$(".swiper-pagination").addClass("active")},10)},onSlideChangeStart:function(t){e.handleCarouselSlideChangeStart(t)},onSlideChangeEnd:function(t){e.handleCarouselSlideChangeEnd(t)}})},t.setupParallaxEffects=function(){var e,t=new ParallaxFactory(5);$("#landing").mousemove(function(a){e=t.getMatrix(this,a),$("#parallax-landing").css("transform","translate3d("+e.X/2+"px, "+e.Y/2+"px, -200px)"),$("#landing .km-logo").css("transform","perspective(200px) translate3d("+-e.X/12+"px, "+-e.Y/12+"px, 0)")}),$("#quote").mousemove(function(a){e=t.getMatrix(this,a),$("#quote-landing").css("transform","perspective(600px) translate3d("+e.X/2+"px, "+e.Y/2+"px, -10px)")}),$("#location").mousemove(function(a){e=t.getMatrix(this,a),$("#location-landing").css("transform","perspective(600px) translate3d("+e.X/2+"px, "+e.Y/2+"px, -10px)")}),$("#seeyou").mousemove(function(a){e=t.getMatrix(this,a),$("#seeyou-landing").css("transform","perspective(600px) translate3d("+e.X/5+"px, "+e.Y/5+"px, -10px)")})},t.bind=function(){this.setupCarousel(),a.isTouchDevice()||(this.setupParallaxEffects(),this.weddingCountdown=new Countdown("2017-06-23",$("#invitation .countdown"))),$("#backToTop").on("click",function(){t.swiper.slideTo(0,2e3)}),$("#menu-btn, #slider-menu-btn").on("click",function(){$("body").hasClass("menuMode")?$("body").removeClass("menuMode"):($("#menu").scrollTop(0),$("body").addClass("menuMode"))}),$(".rsvp-button-external").on("click",function(){$("body").hasClass("menuMode")||$("#menu-btn").trigger("click")}),$("#matt .gallery-movingUp-area").hover(function(){t.mattPhotoTimeline.reverse(),t.mattPhotoTimeline.timeScale(25)},function(){t.mattPhotoTimeline.stop(),t.mattPhotoTimeline.timeScale(1)}),$("#kriza .gallery-movingUp-area").hover(function(){t.krizaPhotoTimeline.reverse(),t.krizaPhotoTimeline.timeScale(25)},function(){t.krizaPhotoTimeline.stop(),t.krizaPhotoTimeline.timeScale(1)}),$("#matt .gallery-movingDown-area").hover(function(){t.mattPhotoTimeline.play(),t.mattPhotoTimeline.timeScale(25)},function(){t.mattPhotoTimeline.stop(),t.mattPhotoTimeline.timeScale(1)}),$("#kriza .gallery-movingDown-area").hover(function(){t.krizaPhotoTimeline.play(),t.krizaPhotoTimeline.timeScale(25)},function(){t.krizaPhotoTimeline.stop(),t.krizaPhotoTimeline.timeScale(1)})},t}(window),rko.app=function(e){var t={previousMode:void 0,modeLabel:"introMode",$lockIcon:$(".lock-icon"),$logo:$(".logo"),$background:$("#parallax-auth"),$viewContainer:$("#lock"),helloMessages:["Hello!","안녕하세요!"]},a=rko.carouselView,i=new Utils;return t.init=function(){i.disableDefaultTouch(),setTimeout(function(){t.$viewContainer.removeClass("loading")},100),setTimeout(function(){$(".password-hint").html(t.helloMessages[Math.floor(Math.random()*t.helloMessages.length)]),a.init(),document.activeElement.blur()},4e3)},t}(window);