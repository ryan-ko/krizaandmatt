function Utils(){this.keysmap={escape:27}}function ParallaxFactory(e){this.parallaxPackage={},this.maxDeg=e}function Countdown(e,i){this.endtime=e,this.utils=new Utils,this.$target=i,this.timeinterval=void 0}Utils.prototype={convertToTwoDigits:function(e){return e<10?"0"+e:e},isCharacterKeyPress:function(e){return"undefined"==typeof e.which||"number"==typeof e.which&&e.which>0&&(!e.ctrlKey&&!e.metaKey&&!e.altKey&&8!=e.which)}},ParallaxFactory.prototype={getMatrix:function(e,i){var a=this,o=e.clientWidth/2,n=e.clientHeight/2,t=o-(i.pageX-e.offsetLeft),s=n-(i.pageY-e.offsetTop);return a.parallaxPackage.degX=s/n*a.maxDeg+"deg",a.parallaxPackage.degY=t/o*-a.maxDeg+"deg",a.parallaxPackage.X=(i.pageX*-1/2+o/2)/8,a.parallaxPackage.Y=(i.pageY*-1/2+n/2)/8,a.parallaxPackage}},Countdown.prototype={getTimeRemaining:function(e){var i=Date.parse(e)-Date.parse(new Date),a=Math.floor(i/1e3%60),o=Math.floor(i/1e3/60%60),n=Math.floor(i/36e5%24),t=Math.floor(i/864e5);return{total:i,days:this.utils.convertToTwoDigits(t),hours:this.utils.convertToTwoDigits(n),minutes:this.utils.convertToTwoDigits(o),seconds:this.utils.convertToTwoDigits(a)}},initCountdownClock:function(){var e=this;console.log("that.$target",e.$target.children()),e.timeinterval=setInterval(function(){var i=e.getTimeRemaining(e.endtime);e.$target.children(".days").html(i.days),e.$target.children(".hours").html(i.hours),e.$target.children(".mins").html(i.minutes),e.$target.children(".secs").html(i.seconds),i.total<=0&&(clearInterval(e.timeinterval),this.$target.hide())},1e3)},destory:function(){var e=this;clearInterval(e.timeinterval)}},rko.carouselView=function(e){var i={swiper:void 0,swiperGallery:void 0,krizaTimeline:void 0,swiperLock:void 0,bindables:{$plusOneCheckbox:$("#plusone-checkbox"),$rsvpForm:$("#rsvp-form")},mainCarouselConfig:{pagination:".swiper-pagination",direction:"vertical",slidesPerView:1,paginationClickable:!0,spaceBetween:0,mousewheelControl:!0,keyboardControl:!0,simulateTouch:!1,mousewheelForceToAxis:!0,mousewheelInvert:!0,mousewheelSensitivity:.5,onSlideChangeStart:function(e){that.handleCarouselSlideChangeStart(e)},onSlideChangeEnd:function(e){that.handleCarouselSlideChangeEnd(e)}},weddingCountdown:void 0};return i.init=function(e){$("#main").html(e),$("body").removeClass().addClass("carouselMode"),this.bind()},i.setupRSVPForm=function(){var e=$("#plusone-checkbox-result"),i=$("#plusone-input");this.bindables.$plusOneCheckbox.on("click",function(a){$(a.target).is(":checked")?(e.val("Yes"),i.removeClass("hidden")):(e.val("No"),i.addClass("hidden"))}),this.bindables.$rsvpForm.submit(function(e){var i=$(this).attr("action");$.ajax({type:"POST",url:i,data:$(this).serialize(),success:function(e){console.log("RSVP result:",e)}}),e.preventDefault()})},i.unbindRSVPForm=function(){this.bindables.$plusOneCheckbox.off(),this.bindables.$rsvpForm.off()},i.handleCarouselSlideChangeStart=function(e){1===e.activeIndex?$(".swiper-pagination").addClass("light-mode"):$(".swiper-pagination").hasClass("light-mode")&&$(".swiper-pagination").removeClass("light-mode"),3===e.activeIndex?"undefined"==typeof i.krizaTimeline?(i.krizaTimeline=new TimelineLite,i.krizaTimeline.to($(".gallery-scroller"),300,{y:"-100%"}),i.krizaTimeline.stop()):(i.krizaTimeline.restart(),i.krizaTimeline.stop()):($(".kriza-gallery-container .gallery-scroller").removeAttr("style"),"undefined"!=typeof i.krizaTimeline&&(i.krizaTimeline.stop(),i.krizaTimeline.restart())),e.disableMousewheelControl()},i.handleCarouselSlideChangeEnd=function(e){2===e.activeIndex?("undefined"==typeof i.swiperGallery&&(i.swiperGallery=new Swiper(".swiper-container-gallery",{pagination:".swiper-pagination-gallery",direction:"horizontal",slidesPerView:1,effect:"fade",paginationClickable:!0,spaceBetween:0,simulateTouch:!1,keyboardControl:!0,mousewheelControl:!0,mousewheelForceToAxis:!0,mousewheelInvert:!0})),$(".swiper-pagination").addClass("transparent-mode")):$(".swiper-pagination").hasClass("transparent-mode")&&$(".swiper-pagination").removeClass("transparent-mode"),i.swiperLock=setTimeout(function(){e.enableMousewheelControl()},400)},i.setupCarousel=function(){var e=this;i.swiper=new Swiper(".swiper-container",{pagination:".swiper-pagination",direction:"vertical",slidesPerView:1,paginationClickable:!0,spaceBetween:0,mousewheelControl:!0,keyboardControl:!0,simulateTouch:!1,mousewheelForceToAxis:!0,mousewheelInvert:!0,mousewheelSensitivity:.5,onSlideChangeStart:function(i){e.handleCarouselSlideChangeStart(i)},onSlideChangeEnd:function(i){e.handleCarouselSlideChangeEnd(i)}})},i.setupParallaxEffects=function(){var e,i=new ParallaxFactory(5);$("#landing").mousemove(function(a){e=i.getMatrix(this,a),$("#parallax-landing").css("transform","translate3d("+e.X/2+"px, "+e.Y/2+"px, -200px)"),$("#landing .km-logo").css("transform","perspective(200px) translate3d("+-e.X/12+"px, "+-e.Y/12+"px, 0)")})},i.bind=function(){this.setupRSVPForm(),this.setupCarousel(),this.setupParallaxEffects(),this.weddingCountdown=new Countdown("2017-06-23",$("#invitation .countdown")),this.weddingCountdown.initCountdownClock(),$(".gallery-movingUp-area").hover(function(){i.krizaTimeline.reverse(),i.krizaTimeline.timeScale(14)},function(){i.krizaTimeline.stop(),i.krizaTimeline.timeScale(1)}),$(".gallery-movingDown-area").hover(function(){i.krizaTimeline.play(),i.krizaTimeline.timeScale(14)},function(){i.krizaTimeline.stop(),i.krizaTimeline.timeScale(1)}),$(".gallery-movingUp-area").mousedown(function(){i.krizaTimeline.timeScale(60),console.log("hit")}),$(".gallery-movingUp-area").mouseup(function(){i.krizaTimeline.timeScale(14),console.log("hit")}),$(".gallery-movingDown-area").mousedown(function(){i.krizaTimeline.timeScale(60),console.log("hit")}),$(".gallery-movingDown-area").mouseup(function(){i.krizaTimeline.timeScale(14),console.log("hit")}),$(".gallery-movingDown-area").on("click",function(){})},i}(window),rko.passwordView=function(e){var i={previousModeLabel:void 0,modeLabel:"passwordMode",bindables:{$passwordInput:$("#password-input"),$passwordForm:$("#password-form"),$doc:$(document)},$body:$("body"),$passwordErrorMsg:$("#login-error-msg")},a=new Utils,o=rko.carouselView;return i.bind=function(){var e,i=this;i.bindables.$passwordInput.keydown(function(e){i.hidePasswordErrorMessage()}),i.bindables.$doc.keydown(function(o){e=o.keyCode,i.$body.hasClass(i.previousModeLabel)&&a.isCharacterKeyPress(o)&&e!==a.keysmap.escape&&(i.$body.removeClass().addClass(i.modeLabel),i.bindables.$passwordInput.focus()),i.$body.hasClass(i.modeLabel)&&e===a.keysmap.escape&&(i.$body.removeClass().addClass(i.previousModeLabel),i.bindables.$passwordInput.val(""))}),i.bindables.$passwordForm.submit(function(e){var a=$(this).attr("action");$.ajax({type:"POST",url:a,data:$(this).serialize(),success:function(e){e=$.parseJSON(e),"success"===e.result?(i.unbind(),o.init(e.html)):i.showPasswordErrorMessage()}}),e.preventDefault()})},i.unbind=function(){var e=this.bindables;for(var i in e)e.hasOwnProperty(i)&&e[i].off()},i.showPasswordErrorMessage=function(){this.$passwordErrorMsg.addClass("show")},i.hidePasswordErrorMessage=function(){this.$passwordErrorMsg.removeClass("show")},i.init=function(e){this.previousModeLabel=e,this.bind()},i}(window),rko.app=function(e){var i={previousMode:void 0,modeLabel:"introMode",$lockIcon:$(".lock-icon"),$logo:$(".logo"),$background:$("#parallax-auth"),$viewContainer:$("#auth")},a=rko.passwordView;return i.init=function(){a.init(this.modeLabel),this.setupParallaxEffects()},i.setupParallaxEffects=function(){var e,i=new ParallaxFactory(5),a=this;this.$viewContainer.mousemove(function(o){e=i.getMatrix(this,o),a.$lockIcon.css("transform","perspective(40px) translate3d("+-e.X/4+"px, "+-e.Y/4+"px, 0) rotateX("+e.degX+") rotateY("+e.degY+")"),a.$logo.css("transform","perspective(500px) translate3d("+-e.X/8+"px, "+-e.Y/8+"px, 0) rotateX("+e.degX+") rotateY("+e.degY+")"),a.$background.css("transform","perspective(1000px) translate3d("+e.X/2+"px, "+e.Y/2+"px, -20px)")})},i}(window);